# 微博去广告脚本

## 修改说明

本脚本修复了原版本中用户自己发布的微博在好友圈被误过滤的问题。

### 问题描述

在使用好友圈视角浏览时，用户自己发布的微博会被广告过滤规则误判为广告而被过滤掉。这可能是因为：

1. 用户自己发布的微博右上角会显示浏览量
2. 某些微博的浏览量旁边会有"推广"字样，提示用户付费推广

### 解决方案

脚本在过滤广告时会检查以下条件：

1. **识别当前用户**：从 API 响应中获取当前登录用户的 ID（`login_uid` 或 `uid`）
2. **比对发布者**：在过滤标记为广告的微博时，检查该微博的发布者 ID 是否与当前用户 ID 一致
3. **保留自己的微博**：如果微博是用户自己发布的，即使有广告标记（`ad_marked`）或推广标记（`promotion`），也会保留该微博

### 主要改动

1. 创建了本地 JavaScript 脚本文件 `Script/Weibo/Weibo_remove_ads.js`
2. 更新了 `Lpx/Weibo_remove_ads.lpx` 文件，将外部脚本引用改为本地脚本
3. 在 `filterStatuses()` 和 `filterAds()` 函数中添加了用户身份检查逻辑

### 技术细节

过滤函数会检查以下字段：
- `currentUserId`：当前登录用户的 ID
- `status.user.id` 或 `status.user.idstr`：微博发布者的 ID
- `ad_marked`：广告标记
- `isAd` / `is_ad`：广告标识
- `promotion`：推广标识

如果微博有广告相关标记，但发布者 ID 与当前用户 ID 匹配，则保留该微博不过滤。

### 使用方法

在 Loon 中导入 `Lpx/Weibo_remove_ads.lpx` 插件即可。脚本会自动处理用户自己发布的微博，确保不会被误过滤。

### 兼容性

本脚本与原版本保持最大兼容性，只在广告过滤逻辑中增加了用户身份检查，不影响其他功能。
